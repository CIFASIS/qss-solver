#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <math.h>

#include <common/utils.h>


#include <common/model.h>
#include <common/commands.h>
#include <qss/qss_model.h>
#include <classic/classic_model.h>

double __PAR_g = 0;
double __PAR_L = 0;
double __PAR_h_left = 0;
double __PAR_h_right = 0;
double __PAR_hu_left = 0;
double __PAR_hu_right = 0;

void
MOD_settings(SD_simulationSettings settings)
{
	 settings->debug = 0;
	 settings->parallel = FALSE;
	 settings->hybrid = FALSE;
	 settings->method = 4;
}

void
MOD_definition(int i, double *x, double *d, double *alg, double t, double *dx)
{
	int j = 0;
	int j30 = 0;
	int j31 = 0;
	j = i;
	if(j >=0 && j <= 499)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
		j30 = j;
	if (j30 >= 1 && j30 <= 498)
	{
		alg[(j) * 3] = (x[(j30+499) * 3]/sqrt(x[(j30-1) * 3])+x[(j30+500) * 3]/sqrt(x[(j30) * 3]))/(sqrt(x[(j30-1) * 3])+sqrt(x[(j30) * 3]));
		alg[(j) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j30-1) * 3],1.0)/2.0)+(pow(x[(j30) * 3],1.0)/2.0)))*(2.0*(pow(x[(j30) * 3],-1.0/2.0))*x[(j30+500) * 3 + 1]-(pow(x[(j30-1) * 3],-3.0/2.0))*x[(j30-1) * 3 + 1]*x[(j30+499) * 3]-(pow(x[(j30) * 3],-3.0/2.0))*x[(j30+500) * 3]*x[(j30) * 3 + 1]+2.0*x[(j30+499) * 3 + 1]*(pow(x[(j30-1) * 3],-1.0/2.0)))-1.0/2.0*((pow(x[(j30) * 3],-1.0/2.0))*x[(j30) * 3 + 1]+(pow(x[(j30-1) * 3],-1.0/2.0))*x[(j30-1) * 3 + 1])*((pow(x[(j30-1) * 3],1.0)/2.0)+pow((pow(x[(j30) * 3],1.0)/2.0),-2.0))*((pow(x[(j30) * 3],-1.0/2.0))*x[(j30+500) * 3]+(pow(x[(j30-1) * 3],-1.0/2.0))*x[(j30+499) * 3]);
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
		alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
		alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
		j30 = j;
	if (j30 >= 1 && j30 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__PAR_g*(x[(j30-1) * 3]+x[(j30) * 3])/2.0);
		alg[(j+500) * 3 + 1] = 1.0/4.0*__PAR_g*(pow(2.0,1.0)/2.0)*(x[(j30) * 3 + 1]+x[(j30-1) * 3 + 1])*(__PAR_g*pow((x[(j30) * 3]+x[(j30-1) * 3]),-1.0/2.0));
		}
		alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
		alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
		j30 = j;
	if (j30 >= 1 && j30 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j30+500) * 3]/sqrt(x[(j30) * 3])+x[(j30+501) * 3]/sqrt(x[(j30+1) * 3]))/(sqrt(x[(j30) * 3])+sqrt(x[(j30+1) * 3]));
		alg[(j+1000) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j30+1) * 3],1.0)/2.0)+(pow(x[(j30) * 3],1.0)/2.0)))*(2.0*(pow(x[(j30) * 3],-1.0/2.0))*x[(j30+500) * 3 + 1]+2.0*(pow(x[(j30+1) * 3],-1.0/2.0))*x[(j30+501) * 3 + 1]-x[(j30) * 3 + 1]*x[(j30+500) * 3]*(pow(x[(j30) * 3],-3.0/2.0))-x[(j30+501) * 3]*(pow(x[(j30+1) * 3],-3.0/2.0))*x[(j30+1) * 3 + 1])-1.0/2.0*(x[(j30+501) * 3]*(pow(x[(j30+1) * 3],-1.0/2.0))+x[(j30+500) * 3]*(pow(x[(j30) * 3],-1.0/2.0)))*((pow(x[(j30+1) * 3],1.0)/2.0)+pow((pow(x[(j30) * 3],1.0)/2.0),-2.0))*((pow(x[(j30+1) * 3],-1.0/2.0))*x[(j30+1) * 3 + 1]+x[(j30) * 3 + 1]*(pow(x[(j30) * 3],-1.0/2.0)));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
		alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
		alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
		j30 = j;
	if (j30 >= 1 && j30 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__PAR_g*(x[(j30) * 3]+x[(j30+1) * 3])/2.0);
		alg[(j+1500) * 3 + 1] = 1.0/4.0*(x[(j30) * 3 + 1]+x[(j30+1) * 3 + 1])*((x[(j30+1) * 3]+x[(j30) * 3])*pow(__PAR_g,-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g;
		}
		alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
		alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		alg[7500 + 1] = 0.0;
		j30 = j;
	if (j30 >= 1 && j30 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j30+500) * 3]*(x[(j30+500) * 3]-x[(j30+499) * 3]-(alg[(j30) * 3]-alg[(j30+500) * 3])*(x[(j30) * 3]-x[(j30-1) * 3]));
		alg[(j+2500) * 3 + 1] = (5.000000000000000000000000e-01)*(x[(j30+500) * 3 + 1]-(x[(j30) * 3 + 1]-x[(j30-1) * 3 + 1])*(alg[(j30) * 3]-alg[(j30+500) * 3])-x[(j30+499) * 3 + 1]-(x[(j30-1) * 3]-x[(j30) * 3])*(alg[(j30+500) * 3 + 1]-alg[(j30) * 3 + 1]))*(1.0/(alg[(j30+500) * 3]))-(5.000000000000000000000000e-01)*alg[(j30+500) * 3 + 1]*((x[(j30-1) * 3]-x[(j30) * 3])*(alg[(j30) * 3]-alg[(j30+500) * 3])-x[(j30+499) * 3]+x[(j30+500) * 3])*(pow(alg[(j30+500) * 3],-2.0));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
		j30 = j;
	if (j30 >= 1 && j30 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j30+1500) * 3]*(x[(j30+500) * 3]-x[(j30+501) * 3]+(alg[(j30+1000) * 3]+alg[(j30+1500) * 3])*(x[(j30+1) * 3]-x[(j30) * 3]));
		alg[(j+3000) * 3 + 1] = -(5.000000000000000000000000e-01)*(x[(j30+500) * 3]+(alg[(j30+1500) * 3]+alg[(j30+1000) * 3])*(x[(j30+1) * 3]-x[(j30) * 3])-x[(j30+501) * 3])*(pow(alg[(j30+1500) * 3],-2.0))*alg[(j30+1500) * 3 + 1]+(5.000000000000000000000000e-01)*(1.0/(alg[(j30+1500) * 3]))*((alg[(j30+1500) * 3]+alg[(j30+1000) * 3])*(x[(j30+1) * 3 + 1]-x[(j30) * 3 + 1])+x[(j30+500) * 3 + 1]+(alg[(j30+1000) * 3 + 1]+alg[(j30+1500) * 3 + 1])*(x[(j30+1) * 3]-x[(j30) * 3])-x[(j30+501) * 3 + 1]);
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		alg[10497 + 1] = 0.0;
		dx[1] = -((alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]+(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3])*500/__PAR_L;
		dx[2] = (-(1.0/(__PAR_L))*(alg[(j+2500) * 3]*(alg[(j) * 3 + 1]+alg[(j+500) * 3 + 1])+(alg[(j+500) * 3]+alg[(j) * 3])*alg[(j+2500) * 3 + 1]+alg[(j+3000) * 3]*(alg[(j+1000) * 3 + 1]-alg[(j+1500) * 3 + 1])-alg[(j+3000) * 3 + 1]*(alg[(j+1500) * 3]-alg[(j+1000) * 3]))*500)/2;
	}
	j = i-500;
	if(j >=0 && j <= 499)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
		j31 = j;
	if (j31 >= 1 && j31 <= 498)
	{
		alg[(j) * 3] = (x[(j31+499) * 3]/sqrt(x[(j31-1) * 3])+x[(j31+500) * 3]/sqrt(x[(j31) * 3]))/(sqrt(x[(j31-1) * 3])+sqrt(x[(j31) * 3]));
		alg[(j) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j31-1) * 3],1.0)/2.0)+(pow(x[(j31) * 3],1.0)/2.0)))*(2.0*(pow(x[(j31) * 3],-1.0/2.0))*x[(j31+500) * 3 + 1]-(pow(x[(j31-1) * 3],-3.0/2.0))*x[(j31-1) * 3 + 1]*x[(j31+499) * 3]-(pow(x[(j31) * 3],-3.0/2.0))*x[(j31+500) * 3]*x[(j31) * 3 + 1]+2.0*x[(j31+499) * 3 + 1]*(pow(x[(j31-1) * 3],-1.0/2.0)))-1.0/2.0*((pow(x[(j31) * 3],-1.0/2.0))*x[(j31) * 3 + 1]+(pow(x[(j31-1) * 3],-1.0/2.0))*x[(j31-1) * 3 + 1])*((pow(x[(j31-1) * 3],1.0)/2.0)+pow((pow(x[(j31) * 3],1.0)/2.0),-2.0))*((pow(x[(j31) * 3],-1.0/2.0))*x[(j31+500) * 3]+(pow(x[(j31-1) * 3],-1.0/2.0))*x[(j31+499) * 3]);
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
		alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
		alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
		j31 = j;
	if (j31 >= 1 && j31 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__PAR_g*(x[(j31-1) * 3]+x[(j31) * 3])/2.0);
		alg[(j+500) * 3 + 1] = 1.0/4.0*__PAR_g*(pow(2.0,1.0)/2.0)*(x[(j31) * 3 + 1]+x[(j31-1) * 3 + 1])*(__PAR_g*pow((x[(j31) * 3]+x[(j31-1) * 3]),-1.0/2.0));
		}
		alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
		alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
		j31 = j;
	if (j31 >= 1 && j31 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j31+500) * 3]/sqrt(x[(j31) * 3])+x[(j31+501) * 3]/sqrt(x[(j31+1) * 3]))/(sqrt(x[(j31) * 3])+sqrt(x[(j31+1) * 3]));
		alg[(j+1000) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j31+1) * 3],1.0)/2.0)+(pow(x[(j31) * 3],1.0)/2.0)))*(2.0*(pow(x[(j31) * 3],-1.0/2.0))*x[(j31+500) * 3 + 1]+2.0*(pow(x[(j31+1) * 3],-1.0/2.0))*x[(j31+501) * 3 + 1]-x[(j31) * 3 + 1]*x[(j31+500) * 3]*(pow(x[(j31) * 3],-3.0/2.0))-x[(j31+501) * 3]*(pow(x[(j31+1) * 3],-3.0/2.0))*x[(j31+1) * 3 + 1])-1.0/2.0*(x[(j31+501) * 3]*(pow(x[(j31+1) * 3],-1.0/2.0))+x[(j31+500) * 3]*(pow(x[(j31) * 3],-1.0/2.0)))*((pow(x[(j31+1) * 3],1.0)/2.0)+pow((pow(x[(j31) * 3],1.0)/2.0),-2.0))*((pow(x[(j31+1) * 3],-1.0/2.0))*x[(j31+1) * 3 + 1]+x[(j31) * 3 + 1]*(pow(x[(j31) * 3],-1.0/2.0)));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
		alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
		alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
		j31 = j;
	if (j31 >= 1 && j31 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__PAR_g*(x[(j31) * 3]+x[(j31+1) * 3])/2.0);
		alg[(j+1500) * 3 + 1] = 1.0/4.0*(x[(j31) * 3 + 1]+x[(j31+1) * 3 + 1])*((x[(j31+1) * 3]+x[(j31) * 3])*pow(__PAR_g,-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g;
		}
		alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
		alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		alg[7500 + 1] = 0.0;
		j31 = j;
	if (j31 >= 1 && j31 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j31+500) * 3]*(x[(j31+500) * 3]-x[(j31+499) * 3]-(alg[(j31) * 3]-alg[(j31+500) * 3])*(x[(j31) * 3]-x[(j31-1) * 3]));
		alg[(j+2500) * 3 + 1] = (5.000000000000000000000000e-01)*(x[(j31+500) * 3 + 1]-(x[(j31) * 3 + 1]-x[(j31-1) * 3 + 1])*(alg[(j31) * 3]-alg[(j31+500) * 3])-x[(j31+499) * 3 + 1]-(x[(j31-1) * 3]-x[(j31) * 3])*(alg[(j31+500) * 3 + 1]-alg[(j31) * 3 + 1]))*(1.0/(alg[(j31+500) * 3]))-(5.000000000000000000000000e-01)*alg[(j31+500) * 3 + 1]*((x[(j31-1) * 3]-x[(j31) * 3])*(alg[(j31) * 3]-alg[(j31+500) * 3])-x[(j31+499) * 3]+x[(j31+500) * 3])*(pow(alg[(j31+500) * 3],-2.0));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
		j31 = j;
	if (j31 >= 1 && j31 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j31+1500) * 3]*(x[(j31+500) * 3]-x[(j31+501) * 3]+(alg[(j31+1000) * 3]+alg[(j31+1500) * 3])*(x[(j31+1) * 3]-x[(j31) * 3]));
		alg[(j+3000) * 3 + 1] = -(5.000000000000000000000000e-01)*(x[(j31+500) * 3]+(alg[(j31+1500) * 3]+alg[(j31+1000) * 3])*(x[(j31+1) * 3]-x[(j31) * 3])-x[(j31+501) * 3])*(pow(alg[(j31+1500) * 3],-2.0))*alg[(j31+1500) * 3 + 1]+(5.000000000000000000000000e-01)*(1.0/(alg[(j31+1500) * 3]))*((alg[(j31+1500) * 3]+alg[(j31+1000) * 3])*(x[(j31+1) * 3 + 1]-x[(j31) * 3 + 1])+x[(j31+500) * 3 + 1]+(alg[(j31+1000) * 3 + 1]+alg[(j31+1500) * 3 + 1])*(x[(j31+1) * 3]-x[(j31) * 3])-x[(j31+501) * 3 + 1]);
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		alg[10497 + 1] = 0.0;
		dx[1] = -(pow((alg[(j) * 3]+alg[(j+500) * 3]),2.0)*alg[(j+2500) * 3]+pow((alg[(j+1000) * 3]-alg[(j+1500) * 3]),2.0)*alg[(j+3000) * 3])*500/__PAR_L;
		dx[2] = (-500*(alg[(j+2500) * 3 + 1]*(alg[(j) * 3]+pow(alg[(j+500) * 3],2.0))+2.0*(alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]*(alg[(j) * 3 + 1]+alg[(j+500) * 3 + 1])+(alg[(j+1000) * 3]-pow(alg[(j+1500) * 3],2.0))*alg[(j+3000) * 3 + 1]+2.0*(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3]*(alg[(j+1000) * 3 + 1]-alg[(j+1500) * 3 + 1]))*(1.0/(__PAR_L)))/2;
	}
}

void
MOD_dependencies(int i, double *x, double *d, double *alg, double t, double *der, int *map)
{
	int j = 0;
	int j30 = 0;
	int j31 = 0;
	int j32 = 0;
	int j33 = 0;
	int j34 = 0;
	int j35 = 0;
	int j36 = 0;
	int j37 = 0;
	switch(i)
	{
		case 0:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
			alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
			alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
			alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
			alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
			alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
			alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
			alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
			alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[7500 + 1] = 0.0;
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			alg[10497 + 1] = 0.0;
			der[0 + 1] = -((alg[0]+alg[1500])*alg[7500]+(alg[3000]-alg[4500])*alg[9000])*500/__PAR_L;
			der[0 + 2] = (-(1.0/(__PAR_L))*(alg[7500]*(alg[1]+alg[1501])+(alg[1500]+alg[0])*alg[7501]+alg[9000]*(alg[3001]-alg[4501])-alg[9001]*(alg[4500]-alg[3000]))*500)/2;
			der[1500 + 1] = -(pow((alg[0]+alg[1500]),2.0)*alg[7500]+pow((alg[3000]-alg[4500]),2.0)*alg[9000])*500/__PAR_L;
			der[1500 + 2] = (-500*(alg[7501]*(alg[0]+pow(alg[1500],2.0))+2.0*(alg[0]+alg[1500])*alg[7500]*(alg[1]+alg[1501])+(alg[3000]-pow(alg[4500],2.0))*alg[9001]+2.0*(alg[3000]-alg[4500])*alg[9000]*(alg[3001]-alg[4501]))*(1.0/(__PAR_L)))/2;
			break;
		case 1:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
			alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
			alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
			alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
			alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
			alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
			alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
			alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
			alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[7500 + 1] = 0.0;
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			alg[10497 + 1] = 0.0;
			der[0 + 1] = -((alg[0]+alg[1500])*alg[7500]+(alg[3000]-alg[4500])*alg[9000])*500/__PAR_L;
			der[0 + 2] = (-(1.0/(__PAR_L))*(alg[7500]*(alg[1]+alg[1501])+(alg[1500]+alg[0])*alg[7501]+alg[9000]*(alg[3001]-alg[4501])-alg[9001]*(alg[4500]-alg[3000]))*500)/2;
			der[1500 + 1] = -(pow((alg[0]+alg[1500]),2.0)*alg[7500]+pow((alg[3000]-alg[4500]),2.0)*alg[9000])*500/__PAR_L;
			der[1500 + 2] = (-500*(alg[7501]*(alg[0]+pow(alg[1500],2.0))+2.0*(alg[0]+alg[1500])*alg[7500]*(alg[1]+alg[1501])+(alg[3000]-pow(alg[4500],2.0))*alg[9001]+2.0*(alg[3000]-alg[4500])*alg[9000]*(alg[3001]-alg[4501]))*(1.0/(__PAR_L)))/2;
			break;
		case 498:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
			alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
			alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
			alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
			alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
			alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
			alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
			alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
			alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[7500 + 1] = 0.0;
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			alg[10497 + 1] = 0.0;
			der[1497 + 1] = -((alg[1497]+alg[2997])*alg[8997]+(alg[4497]-alg[5997])*alg[10497])*500/__PAR_L;
			der[1497 + 2] = (-(1.0/(__PAR_L))*(alg[8997]*(alg[1498]+alg[2998])+(alg[2997]+alg[1497])*alg[8998]+alg[10497]*(alg[4498]-alg[5998])-alg[10498]*(alg[5997]-alg[4497]))*500)/2;
			der[2997 + 1] = -(pow((alg[1497]+alg[2997]),2.0)*alg[8997]+pow((alg[4497]-alg[5997]),2.0)*alg[10497])*500/__PAR_L;
			der[2997 + 2] = (-500*(alg[8998]*(alg[1497]+pow(alg[2997],2.0))+2.0*(alg[1497]+alg[2997])*alg[8997]*(alg[1498]+alg[2998])+(alg[4497]-pow(alg[5997],2.0))*alg[10498]+2.0*(alg[4497]-alg[5997])*alg[10497]*(alg[4498]-alg[5998]))*(1.0/(__PAR_L)))/2;
			break;
		case 499:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
			alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
			alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
			alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
			alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
			alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
			alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
			alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
			alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[7500 + 1] = 0.0;
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			alg[10497 + 1] = 0.0;
			der[1497 + 1] = -((alg[1497]+alg[2997])*alg[8997]+(alg[4497]-alg[5997])*alg[10497])*500/__PAR_L;
			der[1497 + 2] = (-(1.0/(__PAR_L))*(alg[8997]*(alg[1498]+alg[2998])+(alg[2997]+alg[1497])*alg[8998]+alg[10497]*(alg[4498]-alg[5998])-alg[10498]*(alg[5997]-alg[4497]))*500)/2;
			der[2997 + 1] = -(pow((alg[1497]+alg[2997]),2.0)*alg[8997]+pow((alg[4497]-alg[5997]),2.0)*alg[10497])*500/__PAR_L;
			der[2997 + 2] = (-500*(alg[8998]*(alg[1497]+pow(alg[2997],2.0))+2.0*(alg[1497]+alg[2997])*alg[8997]*(alg[1498]+alg[2998])+(alg[4497]-pow(alg[5997],2.0))*alg[10498]+2.0*(alg[4497]-alg[5997])*alg[10497]*(alg[4498]-alg[5998]))*(1.0/(__PAR_L)))/2;
			break;
		case 500:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
			alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
			alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
			alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
			alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
			alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
			alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
			alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
			alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[7500 + 1] = 0.0;
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			alg[10497 + 1] = 0.0;
			der[0 + 1] = -((alg[0]+alg[1500])*alg[7500]+(alg[3000]-alg[4500])*alg[9000])*500/__PAR_L;
			der[0 + 2] = (-(1.0/(__PAR_L))*(alg[7500]*(alg[1]+alg[1501])+(alg[1500]+alg[0])*alg[7501]+alg[9000]*(alg[3001]-alg[4501])-alg[9001]*(alg[4500]-alg[3000]))*500)/2;
			der[1500 + 1] = -(pow((alg[0]+alg[1500]),2.0)*alg[7500]+pow((alg[3000]-alg[4500]),2.0)*alg[9000])*500/__PAR_L;
			der[1500 + 2] = (-500*(alg[7501]*(alg[0]+pow(alg[1500],2.0))+2.0*(alg[0]+alg[1500])*alg[7500]*(alg[1]+alg[1501])+(alg[3000]-pow(alg[4500],2.0))*alg[9001]+2.0*(alg[3000]-alg[4500])*alg[9000]*(alg[3001]-alg[4501]))*(1.0/(__PAR_L)))/2;
			break;
		case 501:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
			alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
			alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
			alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
			alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
			alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
			alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
			alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
			alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[7500 + 1] = 0.0;
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			alg[10497 + 1] = 0.0;
			der[0 + 1] = -((alg[0]+alg[1500])*alg[7500]+(alg[3000]-alg[4500])*alg[9000])*500/__PAR_L;
			der[0 + 2] = (-(1.0/(__PAR_L))*(alg[7500]*(alg[1]+alg[1501])+(alg[1500]+alg[0])*alg[7501]+alg[9000]*(alg[3001]-alg[4501])-alg[9001]*(alg[4500]-alg[3000]))*500)/2;
			der[1500 + 1] = -(pow((alg[0]+alg[1500]),2.0)*alg[7500]+pow((alg[3000]-alg[4500]),2.0)*alg[9000])*500/__PAR_L;
			der[1500 + 2] = (-500*(alg[7501]*(alg[0]+pow(alg[1500],2.0))+2.0*(alg[0]+alg[1500])*alg[7500]*(alg[1]+alg[1501])+(alg[3000]-pow(alg[4500],2.0))*alg[9001]+2.0*(alg[3000]-alg[4500])*alg[9000]*(alg[3001]-alg[4501]))*(1.0/(__PAR_L)))/2;
			break;
		case 998:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
			alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
			alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
			alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
			alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
			alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
			alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
			alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
			alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[7500 + 1] = 0.0;
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			alg[10497 + 1] = 0.0;
			der[1497 + 1] = -((alg[1497]+alg[2997])*alg[8997]+(alg[4497]-alg[5997])*alg[10497])*500/__PAR_L;
			der[1497 + 2] = (-(1.0/(__PAR_L))*(alg[8997]*(alg[1498]+alg[2998])+(alg[2997]+alg[1497])*alg[8998]+alg[10497]*(alg[4498]-alg[5998])-alg[10498]*(alg[5997]-alg[4497]))*500)/2;
			der[2997 + 1] = -(pow((alg[1497]+alg[2997]),2.0)*alg[8997]+pow((alg[4497]-alg[5997]),2.0)*alg[10497])*500/__PAR_L;
			der[2997 + 2] = (-500*(alg[8998]*(alg[1497]+pow(alg[2997],2.0))+2.0*(alg[1497]+alg[2997])*alg[8997]*(alg[1498]+alg[2998])+(alg[4497]-pow(alg[5997],2.0))*alg[10498]+2.0*(alg[4497]-alg[5997])*alg[10497]*(alg[4498]-alg[5998]))*(1.0/(__PAR_L)))/2;
			break;
		case 999:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
			alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
			alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
			alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
			alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
			alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
			alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
			alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
			alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[7500 + 1] = 0.0;
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			alg[10497 + 1] = 0.0;
			der[1497 + 1] = -((alg[1497]+alg[2997])*alg[8997]+(alg[4497]-alg[5997])*alg[10497])*500/__PAR_L;
			der[1497 + 2] = (-(1.0/(__PAR_L))*(alg[8997]*(alg[1498]+alg[2998])+(alg[2997]+alg[1497])*alg[8998]+alg[10497]*(alg[4498]-alg[5998])-alg[10498]*(alg[5997]-alg[4497]))*500)/2;
			der[2997 + 1] = -(pow((alg[1497]+alg[2997]),2.0)*alg[8997]+pow((alg[4497]-alg[5997]),2.0)*alg[10497])*500/__PAR_L;
			der[2997 + 2] = (-500*(alg[8998]*(alg[1497]+pow(alg[2997],2.0))+2.0*(alg[1497]+alg[2997])*alg[8997]*(alg[1498]+alg[2998])+(alg[4497]-pow(alg[5997],2.0))*alg[10498]+2.0*(alg[4497]-alg[5997])*alg[10497]*(alg[4498]-alg[5998]))*(1.0/(__PAR_L)))/2;
			break;
	}
	j = i+1;
	if(j >=1 && j <= 498)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
		j32 = j;
	if (j32 >= 1 && j32 <= 498)
	{
		alg[(j) * 3] = (x[(j32+499) * 3]/sqrt(x[(j32-1) * 3])+x[(j32+500) * 3]/sqrt(x[(j32) * 3]))/(sqrt(x[(j32-1) * 3])+sqrt(x[(j32) * 3]));
		alg[(j) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j32-1) * 3],1.0)/2.0)+(pow(x[(j32) * 3],1.0)/2.0)))*(2.0*(pow(x[(j32) * 3],-1.0/2.0))*x[(j32+500) * 3 + 1]-(pow(x[(j32-1) * 3],-3.0/2.0))*x[(j32-1) * 3 + 1]*x[(j32+499) * 3]-(pow(x[(j32) * 3],-3.0/2.0))*x[(j32+500) * 3]*x[(j32) * 3 + 1]+2.0*x[(j32+499) * 3 + 1]*(pow(x[(j32-1) * 3],-1.0/2.0)))-1.0/2.0*((pow(x[(j32) * 3],-1.0/2.0))*x[(j32) * 3 + 1]+(pow(x[(j32-1) * 3],-1.0/2.0))*x[(j32-1) * 3 + 1])*((pow(x[(j32-1) * 3],1.0)/2.0)+pow((pow(x[(j32) * 3],1.0)/2.0),-2.0))*((pow(x[(j32) * 3],-1.0/2.0))*x[(j32+500) * 3]+(pow(x[(j32-1) * 3],-1.0/2.0))*x[(j32+499) * 3]);
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
		alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
		alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
		j32 = j;
	if (j32 >= 1 && j32 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__PAR_g*(x[(j32-1) * 3]+x[(j32) * 3])/2.0);
		alg[(j+500) * 3 + 1] = 1.0/4.0*__PAR_g*(pow(2.0,1.0)/2.0)*(x[(j32) * 3 + 1]+x[(j32-1) * 3 + 1])*(__PAR_g*pow((x[(j32) * 3]+x[(j32-1) * 3]),-1.0/2.0));
		}
		alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
		alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
		j32 = j;
	if (j32 >= 1 && j32 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j32+500) * 3]/sqrt(x[(j32) * 3])+x[(j32+501) * 3]/sqrt(x[(j32+1) * 3]))/(sqrt(x[(j32) * 3])+sqrt(x[(j32+1) * 3]));
		alg[(j+1000) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j32+1) * 3],1.0)/2.0)+(pow(x[(j32) * 3],1.0)/2.0)))*(2.0*(pow(x[(j32) * 3],-1.0/2.0))*x[(j32+500) * 3 + 1]+2.0*(pow(x[(j32+1) * 3],-1.0/2.0))*x[(j32+501) * 3 + 1]-x[(j32) * 3 + 1]*x[(j32+500) * 3]*(pow(x[(j32) * 3],-3.0/2.0))-x[(j32+501) * 3]*(pow(x[(j32+1) * 3],-3.0/2.0))*x[(j32+1) * 3 + 1])-1.0/2.0*(x[(j32+501) * 3]*(pow(x[(j32+1) * 3],-1.0/2.0))+x[(j32+500) * 3]*(pow(x[(j32) * 3],-1.0/2.0)))*((pow(x[(j32+1) * 3],1.0)/2.0)+pow((pow(x[(j32) * 3],1.0)/2.0),-2.0))*((pow(x[(j32+1) * 3],-1.0/2.0))*x[(j32+1) * 3 + 1]+x[(j32) * 3 + 1]*(pow(x[(j32) * 3],-1.0/2.0)));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
		alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
		alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
		j32 = j;
	if (j32 >= 1 && j32 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__PAR_g*(x[(j32) * 3]+x[(j32+1) * 3])/2.0);
		alg[(j+1500) * 3 + 1] = 1.0/4.0*(x[(j32) * 3 + 1]+x[(j32+1) * 3 + 1])*((x[(j32+1) * 3]+x[(j32) * 3])*pow(__PAR_g,-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g;
		}
		alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
		alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		alg[7500 + 1] = 0.0;
		j32 = j;
	if (j32 >= 1 && j32 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j32+500) * 3]*(x[(j32+500) * 3]-x[(j32+499) * 3]-(alg[(j32) * 3]-alg[(j32+500) * 3])*(x[(j32) * 3]-x[(j32-1) * 3]));
		alg[(j+2500) * 3 + 1] = (5.000000000000000000000000e-01)*(x[(j32+500) * 3 + 1]-(x[(j32) * 3 + 1]-x[(j32-1) * 3 + 1])*(alg[(j32) * 3]-alg[(j32+500) * 3])-x[(j32+499) * 3 + 1]-(x[(j32-1) * 3]-x[(j32) * 3])*(alg[(j32+500) * 3 + 1]-alg[(j32) * 3 + 1]))*(1.0/(alg[(j32+500) * 3]))-(5.000000000000000000000000e-01)*alg[(j32+500) * 3 + 1]*((x[(j32-1) * 3]-x[(j32) * 3])*(alg[(j32) * 3]-alg[(j32+500) * 3])-x[(j32+499) * 3]+x[(j32+500) * 3])*(pow(alg[(j32+500) * 3],-2.0));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
		j32 = j;
	if (j32 >= 1 && j32 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j32+1500) * 3]*(x[(j32+500) * 3]-x[(j32+501) * 3]+(alg[(j32+1000) * 3]+alg[(j32+1500) * 3])*(x[(j32+1) * 3]-x[(j32) * 3]));
		alg[(j+3000) * 3 + 1] = -(5.000000000000000000000000e-01)*(x[(j32+500) * 3]+(alg[(j32+1500) * 3]+alg[(j32+1000) * 3])*(x[(j32+1) * 3]-x[(j32) * 3])-x[(j32+501) * 3])*(pow(alg[(j32+1500) * 3],-2.0))*alg[(j32+1500) * 3 + 1]+(5.000000000000000000000000e-01)*(1.0/(alg[(j32+1500) * 3]))*((alg[(j32+1500) * 3]+alg[(j32+1000) * 3])*(x[(j32+1) * 3 + 1]-x[(j32) * 3 + 1])+x[(j32+500) * 3 + 1]+(alg[(j32+1000) * 3 + 1]+alg[(j32+1500) * 3 + 1])*(x[(j32+1) * 3]-x[(j32) * 3])-x[(j32+501) * 3 + 1]);
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		alg[10497 + 1] = 0.0;
		der[(j) * 3 + 1] = -((alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]+(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3])*500/__PAR_L;
		der[(j) * 3 + 2] = (-(1.0/(__PAR_L))*(alg[(j+2500) * 3]*(alg[(j) * 3 + 1]+alg[(j+500) * 3 + 1])+(alg[(j+500) * 3]+alg[(j) * 3])*alg[(j+2500) * 3 + 1]+alg[(j+3000) * 3]*(alg[(j+1000) * 3 + 1]-alg[(j+1500) * 3 + 1])-alg[(j+3000) * 3 + 1]*(alg[(j+1500) * 3]-alg[(j+1000) * 3]))*500)/2;
		der[(j+500) * 3 + 1] = -(pow((alg[(j) * 3]+alg[(j+500) * 3]),2.0)*alg[(j+2500) * 3]+pow((alg[(j+1000) * 3]-alg[(j+1500) * 3]),2.0)*alg[(j+3000) * 3])*500/__PAR_L;
		der[(j+500) * 3 + 2] = (-500*(alg[(j+2500) * 3 + 1]*(alg[(j) * 3]+pow(alg[(j+500) * 3],2.0))+2.0*(alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]*(alg[(j) * 3 + 1]+alg[(j+500) * 3 + 1])+(alg[(j+1000) * 3]-pow(alg[(j+1500) * 3],2.0))*alg[(j+3000) * 3 + 1]+2.0*(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3]*(alg[(j+1000) * 3 + 1]-alg[(j+1500) * 3 + 1]))*(1.0/(__PAR_L)))/2;
	}
	j = i;
	if(j >=1 && j <= 498)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
		j33 = j;
	if (j33 >= 1 && j33 <= 498)
	{
		alg[(j) * 3] = (x[(j33+499) * 3]/sqrt(x[(j33-1) * 3])+x[(j33+500) * 3]/sqrt(x[(j33) * 3]))/(sqrt(x[(j33-1) * 3])+sqrt(x[(j33) * 3]));
		alg[(j) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j33-1) * 3],1.0)/2.0)+(pow(x[(j33) * 3],1.0)/2.0)))*(2.0*(pow(x[(j33) * 3],-1.0/2.0))*x[(j33+500) * 3 + 1]-(pow(x[(j33-1) * 3],-3.0/2.0))*x[(j33-1) * 3 + 1]*x[(j33+499) * 3]-(pow(x[(j33) * 3],-3.0/2.0))*x[(j33+500) * 3]*x[(j33) * 3 + 1]+2.0*x[(j33+499) * 3 + 1]*(pow(x[(j33-1) * 3],-1.0/2.0)))-1.0/2.0*((pow(x[(j33) * 3],-1.0/2.0))*x[(j33) * 3 + 1]+(pow(x[(j33-1) * 3],-1.0/2.0))*x[(j33-1) * 3 + 1])*((pow(x[(j33-1) * 3],1.0)/2.0)+pow((pow(x[(j33) * 3],1.0)/2.0),-2.0))*((pow(x[(j33) * 3],-1.0/2.0))*x[(j33+500) * 3]+(pow(x[(j33-1) * 3],-1.0/2.0))*x[(j33+499) * 3]);
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
		alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
		alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
		j33 = j;
	if (j33 >= 1 && j33 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__PAR_g*(x[(j33-1) * 3]+x[(j33) * 3])/2.0);
		alg[(j+500) * 3 + 1] = 1.0/4.0*__PAR_g*(pow(2.0,1.0)/2.0)*(x[(j33) * 3 + 1]+x[(j33-1) * 3 + 1])*(__PAR_g*pow((x[(j33) * 3]+x[(j33-1) * 3]),-1.0/2.0));
		}
		alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
		alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
		j33 = j;
	if (j33 >= 1 && j33 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j33+500) * 3]/sqrt(x[(j33) * 3])+x[(j33+501) * 3]/sqrt(x[(j33+1) * 3]))/(sqrt(x[(j33) * 3])+sqrt(x[(j33+1) * 3]));
		alg[(j+1000) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j33+1) * 3],1.0)/2.0)+(pow(x[(j33) * 3],1.0)/2.0)))*(2.0*(pow(x[(j33) * 3],-1.0/2.0))*x[(j33+500) * 3 + 1]+2.0*(pow(x[(j33+1) * 3],-1.0/2.0))*x[(j33+501) * 3 + 1]-x[(j33) * 3 + 1]*x[(j33+500) * 3]*(pow(x[(j33) * 3],-3.0/2.0))-x[(j33+501) * 3]*(pow(x[(j33+1) * 3],-3.0/2.0))*x[(j33+1) * 3 + 1])-1.0/2.0*(x[(j33+501) * 3]*(pow(x[(j33+1) * 3],-1.0/2.0))+x[(j33+500) * 3]*(pow(x[(j33) * 3],-1.0/2.0)))*((pow(x[(j33+1) * 3],1.0)/2.0)+pow((pow(x[(j33) * 3],1.0)/2.0),-2.0))*((pow(x[(j33+1) * 3],-1.0/2.0))*x[(j33+1) * 3 + 1]+x[(j33) * 3 + 1]*(pow(x[(j33) * 3],-1.0/2.0)));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
		alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
		alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
		j33 = j;
	if (j33 >= 1 && j33 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__PAR_g*(x[(j33) * 3]+x[(j33+1) * 3])/2.0);
		alg[(j+1500) * 3 + 1] = 1.0/4.0*(x[(j33) * 3 + 1]+x[(j33+1) * 3 + 1])*((x[(j33+1) * 3]+x[(j33) * 3])*pow(__PAR_g,-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g;
		}
		alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
		alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		alg[7500 + 1] = 0.0;
		j33 = j;
	if (j33 >= 1 && j33 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j33+500) * 3]*(x[(j33+500) * 3]-x[(j33+499) * 3]-(alg[(j33) * 3]-alg[(j33+500) * 3])*(x[(j33) * 3]-x[(j33-1) * 3]));
		alg[(j+2500) * 3 + 1] = (5.000000000000000000000000e-01)*(x[(j33+500) * 3 + 1]-(x[(j33) * 3 + 1]-x[(j33-1) * 3 + 1])*(alg[(j33) * 3]-alg[(j33+500) * 3])-x[(j33+499) * 3 + 1]-(x[(j33-1) * 3]-x[(j33) * 3])*(alg[(j33+500) * 3 + 1]-alg[(j33) * 3 + 1]))*(1.0/(alg[(j33+500) * 3]))-(5.000000000000000000000000e-01)*alg[(j33+500) * 3 + 1]*((x[(j33-1) * 3]-x[(j33) * 3])*(alg[(j33) * 3]-alg[(j33+500) * 3])-x[(j33+499) * 3]+x[(j33+500) * 3])*(pow(alg[(j33+500) * 3],-2.0));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
		j33 = j;
	if (j33 >= 1 && j33 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j33+1500) * 3]*(x[(j33+500) * 3]-x[(j33+501) * 3]+(alg[(j33+1000) * 3]+alg[(j33+1500) * 3])*(x[(j33+1) * 3]-x[(j33) * 3]));
		alg[(j+3000) * 3 + 1] = -(5.000000000000000000000000e-01)*(x[(j33+500) * 3]+(alg[(j33+1500) * 3]+alg[(j33+1000) * 3])*(x[(j33+1) * 3]-x[(j33) * 3])-x[(j33+501) * 3])*(pow(alg[(j33+1500) * 3],-2.0))*alg[(j33+1500) * 3 + 1]+(5.000000000000000000000000e-01)*(1.0/(alg[(j33+1500) * 3]))*((alg[(j33+1500) * 3]+alg[(j33+1000) * 3])*(x[(j33+1) * 3 + 1]-x[(j33) * 3 + 1])+x[(j33+500) * 3 + 1]+(alg[(j33+1000) * 3 + 1]+alg[(j33+1500) * 3 + 1])*(x[(j33+1) * 3]-x[(j33) * 3])-x[(j33+501) * 3 + 1]);
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		alg[10497 + 1] = 0.0;
		der[(j) * 3 + 1] = -((alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]+(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3])*500/__PAR_L;
		der[(j) * 3 + 2] = (-(1.0/(__PAR_L))*(alg[(j+2500) * 3]*(alg[(j) * 3 + 1]+alg[(j+500) * 3 + 1])+(alg[(j+500) * 3]+alg[(j) * 3])*alg[(j+2500) * 3 + 1]+alg[(j+3000) * 3]*(alg[(j+1000) * 3 + 1]-alg[(j+1500) * 3 + 1])-alg[(j+3000) * 3 + 1]*(alg[(j+1500) * 3]-alg[(j+1000) * 3]))*500)/2;
		der[(j+500) * 3 + 1] = -(pow((alg[(j) * 3]+alg[(j+500) * 3]),2.0)*alg[(j+2500) * 3]+pow((alg[(j+1000) * 3]-alg[(j+1500) * 3]),2.0)*alg[(j+3000) * 3])*500/__PAR_L;
		der[(j+500) * 3 + 2] = (-500*(alg[(j+2500) * 3 + 1]*(alg[(j) * 3]+pow(alg[(j+500) * 3],2.0))+2.0*(alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]*(alg[(j) * 3 + 1]+alg[(j+500) * 3 + 1])+(alg[(j+1000) * 3]-pow(alg[(j+1500) * 3],2.0))*alg[(j+3000) * 3 + 1]+2.0*(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3]*(alg[(j+1000) * 3 + 1]-alg[(j+1500) * 3 + 1]))*(1.0/(__PAR_L)))/2;
	}
	j = i-1;
	if(j >=1 && j <= 498)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
		j34 = j;
	if (j34 >= 1 && j34 <= 498)
	{
		alg[(j) * 3] = (x[(j34+499) * 3]/sqrt(x[(j34-1) * 3])+x[(j34+500) * 3]/sqrt(x[(j34) * 3]))/(sqrt(x[(j34-1) * 3])+sqrt(x[(j34) * 3]));
		alg[(j) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j34-1) * 3],1.0)/2.0)+(pow(x[(j34) * 3],1.0)/2.0)))*(2.0*(pow(x[(j34) * 3],-1.0/2.0))*x[(j34+500) * 3 + 1]-(pow(x[(j34-1) * 3],-3.0/2.0))*x[(j34-1) * 3 + 1]*x[(j34+499) * 3]-(pow(x[(j34) * 3],-3.0/2.0))*x[(j34+500) * 3]*x[(j34) * 3 + 1]+2.0*x[(j34+499) * 3 + 1]*(pow(x[(j34-1) * 3],-1.0/2.0)))-1.0/2.0*((pow(x[(j34) * 3],-1.0/2.0))*x[(j34) * 3 + 1]+(pow(x[(j34-1) * 3],-1.0/2.0))*x[(j34-1) * 3 + 1])*((pow(x[(j34-1) * 3],1.0)/2.0)+pow((pow(x[(j34) * 3],1.0)/2.0),-2.0))*((pow(x[(j34) * 3],-1.0/2.0))*x[(j34+500) * 3]+(pow(x[(j34-1) * 3],-1.0/2.0))*x[(j34+499) * 3]);
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
		alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
		alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
		j34 = j;
	if (j34 >= 1 && j34 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__PAR_g*(x[(j34-1) * 3]+x[(j34) * 3])/2.0);
		alg[(j+500) * 3 + 1] = 1.0/4.0*__PAR_g*(pow(2.0,1.0)/2.0)*(x[(j34) * 3 + 1]+x[(j34-1) * 3 + 1])*(__PAR_g*pow((x[(j34) * 3]+x[(j34-1) * 3]),-1.0/2.0));
		}
		alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
		alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
		j34 = j;
	if (j34 >= 1 && j34 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j34+500) * 3]/sqrt(x[(j34) * 3])+x[(j34+501) * 3]/sqrt(x[(j34+1) * 3]))/(sqrt(x[(j34) * 3])+sqrt(x[(j34+1) * 3]));
		alg[(j+1000) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j34+1) * 3],1.0)/2.0)+(pow(x[(j34) * 3],1.0)/2.0)))*(2.0*(pow(x[(j34) * 3],-1.0/2.0))*x[(j34+500) * 3 + 1]+2.0*(pow(x[(j34+1) * 3],-1.0/2.0))*x[(j34+501) * 3 + 1]-x[(j34) * 3 + 1]*x[(j34+500) * 3]*(pow(x[(j34) * 3],-3.0/2.0))-x[(j34+501) * 3]*(pow(x[(j34+1) * 3],-3.0/2.0))*x[(j34+1) * 3 + 1])-1.0/2.0*(x[(j34+501) * 3]*(pow(x[(j34+1) * 3],-1.0/2.0))+x[(j34+500) * 3]*(pow(x[(j34) * 3],-1.0/2.0)))*((pow(x[(j34+1) * 3],1.0)/2.0)+pow((pow(x[(j34) * 3],1.0)/2.0),-2.0))*((pow(x[(j34+1) * 3],-1.0/2.0))*x[(j34+1) * 3 + 1]+x[(j34) * 3 + 1]*(pow(x[(j34) * 3],-1.0/2.0)));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
		alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
		alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
		j34 = j;
	if (j34 >= 1 && j34 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__PAR_g*(x[(j34) * 3]+x[(j34+1) * 3])/2.0);
		alg[(j+1500) * 3 + 1] = 1.0/4.0*(x[(j34) * 3 + 1]+x[(j34+1) * 3 + 1])*((x[(j34+1) * 3]+x[(j34) * 3])*pow(__PAR_g,-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g;
		}
		alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
		alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		alg[7500 + 1] = 0.0;
		j34 = j;
	if (j34 >= 1 && j34 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j34+500) * 3]*(x[(j34+500) * 3]-x[(j34+499) * 3]-(alg[(j34) * 3]-alg[(j34+500) * 3])*(x[(j34) * 3]-x[(j34-1) * 3]));
		alg[(j+2500) * 3 + 1] = (5.000000000000000000000000e-01)*(x[(j34+500) * 3 + 1]-(x[(j34) * 3 + 1]-x[(j34-1) * 3 + 1])*(alg[(j34) * 3]-alg[(j34+500) * 3])-x[(j34+499) * 3 + 1]-(x[(j34-1) * 3]-x[(j34) * 3])*(alg[(j34+500) * 3 + 1]-alg[(j34) * 3 + 1]))*(1.0/(alg[(j34+500) * 3]))-(5.000000000000000000000000e-01)*alg[(j34+500) * 3 + 1]*((x[(j34-1) * 3]-x[(j34) * 3])*(alg[(j34) * 3]-alg[(j34+500) * 3])-x[(j34+499) * 3]+x[(j34+500) * 3])*(pow(alg[(j34+500) * 3],-2.0));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
		j34 = j;
	if (j34 >= 1 && j34 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j34+1500) * 3]*(x[(j34+500) * 3]-x[(j34+501) * 3]+(alg[(j34+1000) * 3]+alg[(j34+1500) * 3])*(x[(j34+1) * 3]-x[(j34) * 3]));
		alg[(j+3000) * 3 + 1] = -(5.000000000000000000000000e-01)*(x[(j34+500) * 3]+(alg[(j34+1500) * 3]+alg[(j34+1000) * 3])*(x[(j34+1) * 3]-x[(j34) * 3])-x[(j34+501) * 3])*(pow(alg[(j34+1500) * 3],-2.0))*alg[(j34+1500) * 3 + 1]+(5.000000000000000000000000e-01)*(1.0/(alg[(j34+1500) * 3]))*((alg[(j34+1500) * 3]+alg[(j34+1000) * 3])*(x[(j34+1) * 3 + 1]-x[(j34) * 3 + 1])+x[(j34+500) * 3 + 1]+(alg[(j34+1000) * 3 + 1]+alg[(j34+1500) * 3 + 1])*(x[(j34+1) * 3]-x[(j34) * 3])-x[(j34+501) * 3 + 1]);
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		alg[10497 + 1] = 0.0;
		der[(j) * 3 + 1] = -((alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]+(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3])*500/__PAR_L;
		der[(j) * 3 + 2] = (-(1.0/(__PAR_L))*(alg[(j+2500) * 3]*(alg[(j) * 3 + 1]+alg[(j+500) * 3 + 1])+(alg[(j+500) * 3]+alg[(j) * 3])*alg[(j+2500) * 3 + 1]+alg[(j+3000) * 3]*(alg[(j+1000) * 3 + 1]-alg[(j+1500) * 3 + 1])-alg[(j+3000) * 3 + 1]*(alg[(j+1500) * 3]-alg[(j+1000) * 3]))*500)/2;
		der[(j+500) * 3 + 1] = -(pow((alg[(j) * 3]+alg[(j+500) * 3]),2.0)*alg[(j+2500) * 3]+pow((alg[(j+1000) * 3]-alg[(j+1500) * 3]),2.0)*alg[(j+3000) * 3])*500/__PAR_L;
		der[(j+500) * 3 + 2] = (-500*(alg[(j+2500) * 3 + 1]*(alg[(j) * 3]+pow(alg[(j+500) * 3],2.0))+2.0*(alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]*(alg[(j) * 3 + 1]+alg[(j+500) * 3 + 1])+(alg[(j+1000) * 3]-pow(alg[(j+1500) * 3],2.0))*alg[(j+3000) * 3 + 1]+2.0*(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3]*(alg[(j+1000) * 3 + 1]-alg[(j+1500) * 3 + 1]))*(1.0/(__PAR_L)))/2;
	}
	j = i-499;
	if(j >=1 && j <= 498)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
		j35 = j;
	if (j35 >= 1 && j35 <= 498)
	{
		alg[(j) * 3] = (x[(j35+499) * 3]/sqrt(x[(j35-1) * 3])+x[(j35+500) * 3]/sqrt(x[(j35) * 3]))/(sqrt(x[(j35-1) * 3])+sqrt(x[(j35) * 3]));
		alg[(j) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j35-1) * 3],1.0)/2.0)+(pow(x[(j35) * 3],1.0)/2.0)))*(2.0*(pow(x[(j35) * 3],-1.0/2.0))*x[(j35+500) * 3 + 1]-(pow(x[(j35-1) * 3],-3.0/2.0))*x[(j35-1) * 3 + 1]*x[(j35+499) * 3]-(pow(x[(j35) * 3],-3.0/2.0))*x[(j35+500) * 3]*x[(j35) * 3 + 1]+2.0*x[(j35+499) * 3 + 1]*(pow(x[(j35-1) * 3],-1.0/2.0)))-1.0/2.0*((pow(x[(j35) * 3],-1.0/2.0))*x[(j35) * 3 + 1]+(pow(x[(j35-1) * 3],-1.0/2.0))*x[(j35-1) * 3 + 1])*((pow(x[(j35-1) * 3],1.0)/2.0)+pow((pow(x[(j35) * 3],1.0)/2.0),-2.0))*((pow(x[(j35) * 3],-1.0/2.0))*x[(j35+500) * 3]+(pow(x[(j35-1) * 3],-1.0/2.0))*x[(j35+499) * 3]);
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
		alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
		alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
		j35 = j;
	if (j35 >= 1 && j35 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__PAR_g*(x[(j35-1) * 3]+x[(j35) * 3])/2.0);
		alg[(j+500) * 3 + 1] = 1.0/4.0*__PAR_g*(pow(2.0,1.0)/2.0)*(x[(j35) * 3 + 1]+x[(j35-1) * 3 + 1])*(__PAR_g*pow((x[(j35) * 3]+x[(j35-1) * 3]),-1.0/2.0));
		}
		alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
		alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
		j35 = j;
	if (j35 >= 1 && j35 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j35+500) * 3]/sqrt(x[(j35) * 3])+x[(j35+501) * 3]/sqrt(x[(j35+1) * 3]))/(sqrt(x[(j35) * 3])+sqrt(x[(j35+1) * 3]));
		alg[(j+1000) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j35+1) * 3],1.0)/2.0)+(pow(x[(j35) * 3],1.0)/2.0)))*(2.0*(pow(x[(j35) * 3],-1.0/2.0))*x[(j35+500) * 3 + 1]+2.0*(pow(x[(j35+1) * 3],-1.0/2.0))*x[(j35+501) * 3 + 1]-x[(j35) * 3 + 1]*x[(j35+500) * 3]*(pow(x[(j35) * 3],-3.0/2.0))-x[(j35+501) * 3]*(pow(x[(j35+1) * 3],-3.0/2.0))*x[(j35+1) * 3 + 1])-1.0/2.0*(x[(j35+501) * 3]*(pow(x[(j35+1) * 3],-1.0/2.0))+x[(j35+500) * 3]*(pow(x[(j35) * 3],-1.0/2.0)))*((pow(x[(j35+1) * 3],1.0)/2.0)+pow((pow(x[(j35) * 3],1.0)/2.0),-2.0))*((pow(x[(j35+1) * 3],-1.0/2.0))*x[(j35+1) * 3 + 1]+x[(j35) * 3 + 1]*(pow(x[(j35) * 3],-1.0/2.0)));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
		alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
		alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
		j35 = j;
	if (j35 >= 1 && j35 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__PAR_g*(x[(j35) * 3]+x[(j35+1) * 3])/2.0);
		alg[(j+1500) * 3 + 1] = 1.0/4.0*(x[(j35) * 3 + 1]+x[(j35+1) * 3 + 1])*((x[(j35+1) * 3]+x[(j35) * 3])*pow(__PAR_g,-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g;
		}
		alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
		alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		alg[7500 + 1] = 0.0;
		j35 = j;
	if (j35 >= 1 && j35 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j35+500) * 3]*(x[(j35+500) * 3]-x[(j35+499) * 3]-(alg[(j35) * 3]-alg[(j35+500) * 3])*(x[(j35) * 3]-x[(j35-1) * 3]));
		alg[(j+2500) * 3 + 1] = (5.000000000000000000000000e-01)*(x[(j35+500) * 3 + 1]-(x[(j35) * 3 + 1]-x[(j35-1) * 3 + 1])*(alg[(j35) * 3]-alg[(j35+500) * 3])-x[(j35+499) * 3 + 1]-(x[(j35-1) * 3]-x[(j35) * 3])*(alg[(j35+500) * 3 + 1]-alg[(j35) * 3 + 1]))*(1.0/(alg[(j35+500) * 3]))-(5.000000000000000000000000e-01)*alg[(j35+500) * 3 + 1]*((x[(j35-1) * 3]-x[(j35) * 3])*(alg[(j35) * 3]-alg[(j35+500) * 3])-x[(j35+499) * 3]+x[(j35+500) * 3])*(pow(alg[(j35+500) * 3],-2.0));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
		j35 = j;
	if (j35 >= 1 && j35 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j35+1500) * 3]*(x[(j35+500) * 3]-x[(j35+501) * 3]+(alg[(j35+1000) * 3]+alg[(j35+1500) * 3])*(x[(j35+1) * 3]-x[(j35) * 3]));
		alg[(j+3000) * 3 + 1] = -(5.000000000000000000000000e-01)*(x[(j35+500) * 3]+(alg[(j35+1500) * 3]+alg[(j35+1000) * 3])*(x[(j35+1) * 3]-x[(j35) * 3])-x[(j35+501) * 3])*(pow(alg[(j35+1500) * 3],-2.0))*alg[(j35+1500) * 3 + 1]+(5.000000000000000000000000e-01)*(1.0/(alg[(j35+1500) * 3]))*((alg[(j35+1500) * 3]+alg[(j35+1000) * 3])*(x[(j35+1) * 3 + 1]-x[(j35) * 3 + 1])+x[(j35+500) * 3 + 1]+(alg[(j35+1000) * 3 + 1]+alg[(j35+1500) * 3 + 1])*(x[(j35+1) * 3]-x[(j35) * 3])-x[(j35+501) * 3 + 1]);
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		alg[10497 + 1] = 0.0;
		der[(j) * 3 + 1] = -((alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]+(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3])*500/__PAR_L;
		der[(j) * 3 + 2] = (-(1.0/(__PAR_L))*(alg[(j+2500) * 3]*(alg[(j) * 3 + 1]+alg[(j+500) * 3 + 1])+(alg[(j+500) * 3]+alg[(j) * 3])*alg[(j+2500) * 3 + 1]+alg[(j+3000) * 3]*(alg[(j+1000) * 3 + 1]-alg[(j+1500) * 3 + 1])-alg[(j+3000) * 3 + 1]*(alg[(j+1500) * 3]-alg[(j+1000) * 3]))*500)/2;
		der[(j+500) * 3 + 1] = -(pow((alg[(j) * 3]+alg[(j+500) * 3]),2.0)*alg[(j+2500) * 3]+pow((alg[(j+1000) * 3]-alg[(j+1500) * 3]),2.0)*alg[(j+3000) * 3])*500/__PAR_L;
		der[(j+500) * 3 + 2] = (-500*(alg[(j+2500) * 3 + 1]*(alg[(j) * 3]+pow(alg[(j+500) * 3],2.0))+2.0*(alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]*(alg[(j) * 3 + 1]+alg[(j+500) * 3 + 1])+(alg[(j+1000) * 3]-pow(alg[(j+1500) * 3],2.0))*alg[(j+3000) * 3 + 1]+2.0*(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3]*(alg[(j+1000) * 3 + 1]-alg[(j+1500) * 3 + 1]))*(1.0/(__PAR_L)))/2;
	}
	j = i-500;
	if(j >=1 && j <= 498)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
		j36 = j;
	if (j36 >= 1 && j36 <= 498)
	{
		alg[(j) * 3] = (x[(j36+499) * 3]/sqrt(x[(j36-1) * 3])+x[(j36+500) * 3]/sqrt(x[(j36) * 3]))/(sqrt(x[(j36-1) * 3])+sqrt(x[(j36) * 3]));
		alg[(j) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j36-1) * 3],1.0)/2.0)+(pow(x[(j36) * 3],1.0)/2.0)))*(2.0*(pow(x[(j36) * 3],-1.0/2.0))*x[(j36+500) * 3 + 1]-(pow(x[(j36-1) * 3],-3.0/2.0))*x[(j36-1) * 3 + 1]*x[(j36+499) * 3]-(pow(x[(j36) * 3],-3.0/2.0))*x[(j36+500) * 3]*x[(j36) * 3 + 1]+2.0*x[(j36+499) * 3 + 1]*(pow(x[(j36-1) * 3],-1.0/2.0)))-1.0/2.0*((pow(x[(j36) * 3],-1.0/2.0))*x[(j36) * 3 + 1]+(pow(x[(j36-1) * 3],-1.0/2.0))*x[(j36-1) * 3 + 1])*((pow(x[(j36-1) * 3],1.0)/2.0)+pow((pow(x[(j36) * 3],1.0)/2.0),-2.0))*((pow(x[(j36) * 3],-1.0/2.0))*x[(j36+500) * 3]+(pow(x[(j36-1) * 3],-1.0/2.0))*x[(j36+499) * 3]);
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
		alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
		alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
		j36 = j;
	if (j36 >= 1 && j36 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__PAR_g*(x[(j36-1) * 3]+x[(j36) * 3])/2.0);
		alg[(j+500) * 3 + 1] = 1.0/4.0*__PAR_g*(pow(2.0,1.0)/2.0)*(x[(j36) * 3 + 1]+x[(j36-1) * 3 + 1])*(__PAR_g*pow((x[(j36) * 3]+x[(j36-1) * 3]),-1.0/2.0));
		}
		alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
		alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
		j36 = j;
	if (j36 >= 1 && j36 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j36+500) * 3]/sqrt(x[(j36) * 3])+x[(j36+501) * 3]/sqrt(x[(j36+1) * 3]))/(sqrt(x[(j36) * 3])+sqrt(x[(j36+1) * 3]));
		alg[(j+1000) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j36+1) * 3],1.0)/2.0)+(pow(x[(j36) * 3],1.0)/2.0)))*(2.0*(pow(x[(j36) * 3],-1.0/2.0))*x[(j36+500) * 3 + 1]+2.0*(pow(x[(j36+1) * 3],-1.0/2.0))*x[(j36+501) * 3 + 1]-x[(j36) * 3 + 1]*x[(j36+500) * 3]*(pow(x[(j36) * 3],-3.0/2.0))-x[(j36+501) * 3]*(pow(x[(j36+1) * 3],-3.0/2.0))*x[(j36+1) * 3 + 1])-1.0/2.0*(x[(j36+501) * 3]*(pow(x[(j36+1) * 3],-1.0/2.0))+x[(j36+500) * 3]*(pow(x[(j36) * 3],-1.0/2.0)))*((pow(x[(j36+1) * 3],1.0)/2.0)+pow((pow(x[(j36) * 3],1.0)/2.0),-2.0))*((pow(x[(j36+1) * 3],-1.0/2.0))*x[(j36+1) * 3 + 1]+x[(j36) * 3 + 1]*(pow(x[(j36) * 3],-1.0/2.0)));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
		alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
		alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
		j36 = j;
	if (j36 >= 1 && j36 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__PAR_g*(x[(j36) * 3]+x[(j36+1) * 3])/2.0);
		alg[(j+1500) * 3 + 1] = 1.0/4.0*(x[(j36) * 3 + 1]+x[(j36+1) * 3 + 1])*((x[(j36+1) * 3]+x[(j36) * 3])*pow(__PAR_g,-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g;
		}
		alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
		alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		alg[7500 + 1] = 0.0;
		j36 = j;
	if (j36 >= 1 && j36 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j36+500) * 3]*(x[(j36+500) * 3]-x[(j36+499) * 3]-(alg[(j36) * 3]-alg[(j36+500) * 3])*(x[(j36) * 3]-x[(j36-1) * 3]));
		alg[(j+2500) * 3 + 1] = (5.000000000000000000000000e-01)*(x[(j36+500) * 3 + 1]-(x[(j36) * 3 + 1]-x[(j36-1) * 3 + 1])*(alg[(j36) * 3]-alg[(j36+500) * 3])-x[(j36+499) * 3 + 1]-(x[(j36-1) * 3]-x[(j36) * 3])*(alg[(j36+500) * 3 + 1]-alg[(j36) * 3 + 1]))*(1.0/(alg[(j36+500) * 3]))-(5.000000000000000000000000e-01)*alg[(j36+500) * 3 + 1]*((x[(j36-1) * 3]-x[(j36) * 3])*(alg[(j36) * 3]-alg[(j36+500) * 3])-x[(j36+499) * 3]+x[(j36+500) * 3])*(pow(alg[(j36+500) * 3],-2.0));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
		j36 = j;
	if (j36 >= 1 && j36 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j36+1500) * 3]*(x[(j36+500) * 3]-x[(j36+501) * 3]+(alg[(j36+1000) * 3]+alg[(j36+1500) * 3])*(x[(j36+1) * 3]-x[(j36) * 3]));
		alg[(j+3000) * 3 + 1] = -(5.000000000000000000000000e-01)*(x[(j36+500) * 3]+(alg[(j36+1500) * 3]+alg[(j36+1000) * 3])*(x[(j36+1) * 3]-x[(j36) * 3])-x[(j36+501) * 3])*(pow(alg[(j36+1500) * 3],-2.0))*alg[(j36+1500) * 3 + 1]+(5.000000000000000000000000e-01)*(1.0/(alg[(j36+1500) * 3]))*((alg[(j36+1500) * 3]+alg[(j36+1000) * 3])*(x[(j36+1) * 3 + 1]-x[(j36) * 3 + 1])+x[(j36+500) * 3 + 1]+(alg[(j36+1000) * 3 + 1]+alg[(j36+1500) * 3 + 1])*(x[(j36+1) * 3]-x[(j36) * 3])-x[(j36+501) * 3 + 1]);
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		alg[10497 + 1] = 0.0;
		der[(j) * 3 + 1] = -((alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]+(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3])*500/__PAR_L;
		der[(j) * 3 + 2] = (-(1.0/(__PAR_L))*(alg[(j+2500) * 3]*(alg[(j) * 3 + 1]+alg[(j+500) * 3 + 1])+(alg[(j+500) * 3]+alg[(j) * 3])*alg[(j+2500) * 3 + 1]+alg[(j+3000) * 3]*(alg[(j+1000) * 3 + 1]-alg[(j+1500) * 3 + 1])-alg[(j+3000) * 3 + 1]*(alg[(j+1500) * 3]-alg[(j+1000) * 3]))*500)/2;
		der[(j+500) * 3 + 1] = -(pow((alg[(j) * 3]+alg[(j+500) * 3]),2.0)*alg[(j+2500) * 3]+pow((alg[(j+1000) * 3]-alg[(j+1500) * 3]),2.0)*alg[(j+3000) * 3])*500/__PAR_L;
		der[(j+500) * 3 + 2] = (-500*(alg[(j+2500) * 3 + 1]*(alg[(j) * 3]+pow(alg[(j+500) * 3],2.0))+2.0*(alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]*(alg[(j) * 3 + 1]+alg[(j+500) * 3 + 1])+(alg[(j+1000) * 3]-pow(alg[(j+1500) * 3],2.0))*alg[(j+3000) * 3 + 1]+2.0*(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3]*(alg[(j+1000) * 3 + 1]-alg[(j+1500) * 3 + 1]))*(1.0/(__PAR_L)))/2;
	}
	j = i-501;
	if(j >=1 && j <= 498)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		alg[0 + 1] = (1.0/(x[0]))*x[1501]-x[1]*(pow(x[0],-2.0))*x[1500];
		j37 = j;
	if (j37 >= 1 && j37 <= 498)
	{
		alg[(j) * 3] = (x[(j37+499) * 3]/sqrt(x[(j37-1) * 3])+x[(j37+500) * 3]/sqrt(x[(j37) * 3]))/(sqrt(x[(j37-1) * 3])+sqrt(x[(j37) * 3]));
		alg[(j) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j37-1) * 3],1.0)/2.0)+(pow(x[(j37) * 3],1.0)/2.0)))*(2.0*(pow(x[(j37) * 3],-1.0/2.0))*x[(j37+500) * 3 + 1]-(pow(x[(j37-1) * 3],-3.0/2.0))*x[(j37-1) * 3 + 1]*x[(j37+499) * 3]-(pow(x[(j37) * 3],-3.0/2.0))*x[(j37+500) * 3]*x[(j37) * 3 + 1]+2.0*x[(j37+499) * 3 + 1]*(pow(x[(j37-1) * 3],-1.0/2.0)))-1.0/2.0*((pow(x[(j37) * 3],-1.0/2.0))*x[(j37) * 3 + 1]+(pow(x[(j37-1) * 3],-1.0/2.0))*x[(j37-1) * 3 + 1])*((pow(x[(j37-1) * 3],1.0)/2.0)+pow((pow(x[(j37) * 3],1.0)/2.0),-2.0))*((pow(x[(j37) * 3],-1.0/2.0))*x[(j37+500) * 3]+(pow(x[(j37-1) * 3],-1.0/2.0))*x[(j37+499) * 3]);
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1497 + 1] = -1.0/2.0*(x[1495]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[1498])*(x[2994]*(pow(x[1494],-1.0/2.0))+(pow(x[1497],-1.0/2.0))*x[2997])*((pow(x[1494],1.0)/2.0)+pow((pow(x[1497],1.0)/2.0),-2.0))-1.0/2.0*((pow(x[1497],-3.0/2.0))*x[2997]*x[1498]+x[2994]*x[1495]*(pow(x[1494],-3.0/2.0))-2.0*(pow(x[1497],-1.0/2.0))*x[2998]-2.0*(pow(x[1494],-1.0/2.0))*x[2995])*(1.0/((pow(x[1494],1.0)/2.0)+(pow(x[1497],1.0)/2.0)));
		alg[1500] = sqrt(__PAR_g*(x[0]+x[0])/2.0);
		alg[1500 + 1] = 1.0/2.0*x[1]*__PAR_g*(x[0]*pow(__PAR_g,-1.0/2.0));
		j37 = j;
	if (j37 >= 1 && j37 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__PAR_g*(x[(j37-1) * 3]+x[(j37) * 3])/2.0);
		alg[(j+500) * 3 + 1] = 1.0/4.0*__PAR_g*(pow(2.0,1.0)/2.0)*(x[(j37) * 3 + 1]+x[(j37-1) * 3 + 1])*(__PAR_g*pow((x[(j37) * 3]+x[(j37-1) * 3]),-1.0/2.0));
		}
		alg[2997] = sqrt(__PAR_g*(x[1494]+x[1497])/2.0);
		alg[2997 + 1] = 1.0/4.0*(__PAR_g*pow((x[1494]+x[1497]),-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g*(x[1498]+x[1495]);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		alg[3000 + 1] = -1.0/2.0*(x[1503]*(pow(x[3],-1.0/2.0))+x[1500]*(pow(x[0],-1.0/2.0)))*((pow(x[0],-1.0/2.0))*x[1]+x[4]*(pow(x[3],-1.0/2.0)))*((pow(x[0],1.0)/2.0)+pow((pow(x[3],1.0)/2.0),-2.0))-1.0/2.0*(1.0/((pow(x[0],1.0)/2.0)+(pow(x[3],1.0)/2.0)))*(x[1500]*(pow(x[0],-3.0/2.0))*x[1]-2.0*x[1504]*(pow(x[3],-1.0/2.0))-2.0*x[1501]*(pow(x[0],-1.0/2.0))+x[1503]*x[4]*(pow(x[3],-3.0/2.0)));
		j37 = j;
	if (j37 >= 1 && j37 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j37+500) * 3]/sqrt(x[(j37) * 3])+x[(j37+501) * 3]/sqrt(x[(j37+1) * 3]))/(sqrt(x[(j37) * 3])+sqrt(x[(j37+1) * 3]));
		alg[(j+1000) * 3 + 1] = 1.0/2.0*(1.0/((pow(x[(j37+1) * 3],1.0)/2.0)+(pow(x[(j37) * 3],1.0)/2.0)))*(2.0*(pow(x[(j37) * 3],-1.0/2.0))*x[(j37+500) * 3 + 1]+2.0*(pow(x[(j37+1) * 3],-1.0/2.0))*x[(j37+501) * 3 + 1]-x[(j37) * 3 + 1]*x[(j37+500) * 3]*(pow(x[(j37) * 3],-3.0/2.0))-x[(j37+501) * 3]*(pow(x[(j37+1) * 3],-3.0/2.0))*x[(j37+1) * 3 + 1])-1.0/2.0*(x[(j37+501) * 3]*(pow(x[(j37+1) * 3],-1.0/2.0))+x[(j37+500) * 3]*(pow(x[(j37) * 3],-1.0/2.0)))*((pow(x[(j37+1) * 3],1.0)/2.0)+pow((pow(x[(j37) * 3],1.0)/2.0),-2.0))*((pow(x[(j37+1) * 3],-1.0/2.0))*x[(j37+1) * 3 + 1]+x[(j37) * 3 + 1]*(pow(x[(j37) * 3],-1.0/2.0)));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4497 + 1] = -x[2997]*x[1498]*(pow(x[1497],-2.0))+x[2998]*(1.0/(x[1497]));
		alg[4500] = sqrt(__PAR_g*(x[0]+x[3])/2.0);
		alg[4500 + 1] = 1.0/4.0*(pow(2.0,1.0)/2.0)*((x[3]+x[0])*pow(__PAR_g,-1.0/2.0))*__PAR_g*(x[1]+x[4]);
		j37 = j;
	if (j37 >= 1 && j37 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__PAR_g*(x[(j37) * 3]+x[(j37+1) * 3])/2.0);
		alg[(j+1500) * 3 + 1] = 1.0/4.0*(x[(j37) * 3 + 1]+x[(j37+1) * 3 + 1])*((x[(j37+1) * 3]+x[(j37) * 3])*pow(__PAR_g,-1.0/2.0))*(pow(2.0,1.0)/2.0)*__PAR_g;
		}
		alg[5997] = sqrt(__PAR_g*(x[1497]+x[1497])/2.0);
		alg[5997 + 1] = 1.0/2.0*(x[1497]*pow(__PAR_g,-1.0/2.0))*x[1498]*__PAR_g;
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		alg[7500 + 1] = 0.0;
		j37 = j;
	if (j37 >= 1 && j37 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j37+500) * 3]*(x[(j37+500) * 3]-x[(j37+499) * 3]-(alg[(j37) * 3]-alg[(j37+500) * 3])*(x[(j37) * 3]-x[(j37-1) * 3]));
		alg[(j+2500) * 3 + 1] = (5.000000000000000000000000e-01)*(x[(j37+500) * 3 + 1]-(x[(j37) * 3 + 1]-x[(j37-1) * 3 + 1])*(alg[(j37) * 3]-alg[(j37+500) * 3])-x[(j37+499) * 3 + 1]-(x[(j37-1) * 3]-x[(j37) * 3])*(alg[(j37+500) * 3 + 1]-alg[(j37) * 3 + 1]))*(1.0/(alg[(j37+500) * 3]))-(5.000000000000000000000000e-01)*alg[(j37+500) * 3 + 1]*((x[(j37-1) * 3]-x[(j37) * 3])*(alg[(j37) * 3]-alg[(j37+500) * 3])-x[(j37+499) * 3]+x[(j37+500) * 3])*(pow(alg[(j37+500) * 3],-2.0));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[8997 + 1] = (5.000000000000000000000000e-01)*(x[2998]-x[2995]-(x[1495]-x[1498])*(alg[1497]-alg[2997])-(x[1497]-x[1494])*(alg[2998]-alg[1498]))*(1.0/(alg[2997]))+(5.000000000000000000000000e-01)*alg[2998]*(pow(alg[2997],-2.0))*(x[2994]-(x[1497]-x[1494])*(alg[1497]-alg[2997])-x[2997]);
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		alg[9000 + 1] = -(5.000000000000000000000000e-01)*(pow(alg[4500],-2.0))*alg[4501]*(x[1500]+(alg[4500]+alg[3000])*(x[3]-x[0])-x[1503])+(5.000000000000000000000000e-01)*((alg[4500]+alg[3000])*(x[4]-x[1])+x[1501]-x[1504]+(alg[3001]+alg[4501])*(x[3]-x[0]))*(1.0/(alg[4500]));
		j37 = j;
	if (j37 >= 1 && j37 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j37+1500) * 3]*(x[(j37+500) * 3]-x[(j37+501) * 3]+(alg[(j37+1000) * 3]+alg[(j37+1500) * 3])*(x[(j37+1) * 3]-x[(j37) * 3]));
		alg[(j+3000) * 3 + 1] = -(5.000000000000000000000000e-01)*(x[(j37+500) * 3]+(alg[(j37+1500) * 3]+alg[(j37+1000) * 3])*(x[(j37+1) * 3]-x[(j37) * 3])-x[(j37+501) * 3])*(pow(alg[(j37+1500) * 3],-2.0))*alg[(j37+1500) * 3 + 1]+(5.000000000000000000000000e-01)*(1.0/(alg[(j37+1500) * 3]))*((alg[(j37+1500) * 3]+alg[(j37+1000) * 3])*(x[(j37+1) * 3 + 1]-x[(j37) * 3 + 1])+x[(j37+500) * 3 + 1]+(alg[(j37+1000) * 3 + 1]+alg[(j37+1500) * 3 + 1])*(x[(j37+1) * 3]-x[(j37) * 3])-x[(j37+501) * 3 + 1]);
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		alg[10497 + 1] = 0.0;
		der[(j) * 3 + 1] = -((alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]+(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3])*500/__PAR_L;
		der[(j) * 3 + 2] = (-(1.0/(__PAR_L))*(alg[(j+2500) * 3]*(alg[(j) * 3 + 1]+alg[(j+500) * 3 + 1])+(alg[(j+500) * 3]+alg[(j) * 3])*alg[(j+2500) * 3 + 1]+alg[(j+3000) * 3]*(alg[(j+1000) * 3 + 1]-alg[(j+1500) * 3 + 1])-alg[(j+3000) * 3 + 1]*(alg[(j+1500) * 3]-alg[(j+1000) * 3]))*500)/2;
		der[(j+500) * 3 + 1] = -(pow((alg[(j) * 3]+alg[(j+500) * 3]),2.0)*alg[(j+2500) * 3]+pow((alg[(j+1000) * 3]-alg[(j+1500) * 3]),2.0)*alg[(j+3000) * 3])*500/__PAR_L;
		der[(j+500) * 3 + 2] = (-500*(alg[(j+2500) * 3 + 1]*(alg[(j) * 3]+pow(alg[(j+500) * 3],2.0))+2.0*(alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]*(alg[(j) * 3 + 1]+alg[(j+500) * 3 + 1])+(alg[(j+1000) * 3]-pow(alg[(j+1500) * 3],2.0))*alg[(j+3000) * 3 + 1]+2.0*(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3]*(alg[(j+1000) * 3 + 1]-alg[(j+1500) * 3 + 1]))*(1.0/(__PAR_L)))/2;
	}
}

void
MOD_output(int i, double *x, double *d, double *alg, double t, double *out)
{
	switch(i)
	{
		case 0:
			out[0] = x[744];
			return;
	}
}

void
QSS_initializeDataStructs(QSS_simulator simulator)
{
	int *outputs = (int*)malloc(1*sizeof(int));
	int *states = (int*)malloc(1000*sizeof(int));
	int i38;
	int i39;
	int i;
	int j = 0;
	simulator->data = QSS_Data(1000,0,0,0,4000,"shallow");
  QSS_data modelData = simulator->data;
  const double t = 0;

	// Allocate main data structures.
	__PAR_g = 1.000000000000000000000000e+00;
	__PAR_L = 1.000000000000000000000000e+01;
	__PAR_h_left = 3.000000000000000000000000e+00;
	__PAR_h_right = 1.000000000000000000000000e+00;
	__PAR_hu_left = 0.000000000000000000000000e+00;
	__PAR_hu_right = 0.000000000000000000000000e+00;
	// Initialize model code.
	for(i38 = 0; i38 <= 249; i38++)
	{
		modelData->x[(i38) * 3] = 3.000000000000000000000000e+00;
	}
	for(i39 = 250; i39 <= 499; i39++)
	{
		modelData->x[(i39) * 3] = 1.000000000000000000000000e+00;
	}
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i]++;
	}
	modelData->nDS[0]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i]++;
	}
	modelData->nDS[0]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i]++;
	}
	modelData->nDS[499]++;
	modelData->nDS[499]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i]++;
	}
	modelData->nDS[0]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i]++;
	}
	modelData->nDS[0]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i]++;
	}
	modelData->nDS[499]++;
	modelData->nDS[499]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i+500]++;
	}
	modelData->nDS[500]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i+500]++;
	}
	modelData->nDS[500]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i+500]++;
	}
	modelData->nDS[999]++;
	modelData->nDS[999]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i+500]++;
	}
	modelData->nDS[500]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i+500]++;
	}
	modelData->nDS[500]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i+500]++;
	}
	modelData->nDS[999]++;
	modelData->nDS[999]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i-1]++;
	}
	modelData->nSD[0]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i]++;
	}
	modelData->nSD[1]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+1]++;
	}
	modelData->nSD[498]++;
	modelData->nSD[499]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+499]++;
	}
	modelData->nSD[500]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+500]++;
	}
	modelData->nSD[501]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+501]++;
	}
	modelData->nSD[998]++;
	modelData->nSD[999]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i-1]++;
	}
	modelData->nSD[0]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i]++;
	}
	modelData->nSD[1]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+1]++;
	}
	modelData->nSD[498]++;
	modelData->nSD[499]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+499]++;
	}
	modelData->nSD[500]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+500]++;
	}
	modelData->nSD[501]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+501]++;
	}
	modelData->nSD[998]++;
	modelData->nSD[999]++;
	QSS_allocDataMatrix(modelData);
	// Initialize model data.
	// Initialize model time.
		cleanVector(states,0,1000);

	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i][states[i]++] = i-1;
	}
	modelData->DS[0][states[0]++] = 0;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i][states[i]++] = i;
	}
	modelData->DS[0][states[0]++] = 1;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i][states[i]++] = i+1;
	}
	modelData->DS[499][states[499]++] = 498;
	modelData->DS[499][states[499]++] = 499;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i][states[i]++] = i+499;
	}
	modelData->DS[0][states[0]++] = 500;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i][states[i]++] = i+500;
	}
	modelData->DS[0][states[0]++] = 501;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i][states[i]++] = i+501;
	}
	modelData->DS[499][states[499]++] = 998;
	modelData->DS[499][states[499]++] = 999;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i+500][states[i+500]++] = i-1;
	}
	modelData->DS[500][states[500]++] = 0;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i+500][states[i+500]++] = i;
	}
	modelData->DS[500][states[500]++] = 1;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i+500][states[i+500]++] = i+1;
	}
	modelData->DS[999][states[999]++] = 498;
	modelData->DS[999][states[999]++] = 499;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i+500][states[i+500]++] = i+499;
	}
	modelData->DS[500][states[500]++] = 500;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i+500][states[i+500]++] = i+500;
	}
	modelData->DS[500][states[500]++] = 501;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i+500][states[i+500]++] = i+501;
	}
	modelData->DS[999][states[999]++] = 998;
	modelData->DS[999][states[999]++] = 999;
		cleanVector(states,0,1000);

	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i-1][states[i-1]++] = i;
	}
	modelData->SD[0][states[0]++] = 0;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i][states[i]++] = i;
	}
	modelData->SD[1][states[1]++] = 0;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+1][states[i+1]++] = i;
	}
	modelData->SD[498][states[498]++] = 499;
	modelData->SD[499][states[499]++] = 499;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+499][states[i+499]++] = i;
	}
	modelData->SD[500][states[500]++] = 0;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+500][states[i+500]++] = i;
	}
	modelData->SD[501][states[501]++] = 0;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+501][states[i+501]++] = i;
	}
	modelData->SD[998][states[998]++] = 499;
	modelData->SD[999][states[999]++] = 499;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i-1][states[i-1]++] = i+500;
	}
	modelData->SD[0][states[0]++] = 500;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i][states[i]++] = i+500;
	}
	modelData->SD[1][states[1]++] = 500;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+1][states[i+1]++] = i+500;
	}
	modelData->SD[498][states[498]++] = 999;
	modelData->SD[499][states[499]++] = 999;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+499][states[i+499]++] = i+500;
	}
	modelData->SD[500][states[500]++] = 500;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+500][states[i+500]++] = i+500;
	}
	modelData->SD[501][states[501]++] = 500;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+501][states[i+501]++] = i+500;
	}
	modelData->SD[998][states[998]++] = 999;
	modelData->SD[999][states[999]++] = 999;
	simulator->time = QSS_Time(1000,0,0,0,ST_Binary,NULL);

	simulator->output = SD_Output("shallow",1,0,1000,NULL,0,0,CI_Step,SD_Memory,MOD_output);
SD_output modelOutput = simulator->output;

		modelOutput->nOS[0] = 1;
		modelOutput->nSO[248]++;
	SD_allocOutputMatrix(modelOutput,1000,0);
		cleanVector(states,0,1000);

		cleanVector(outputs,0,1);

		sprintf(modelOutput->variable[0].name,"h[249]");
		cleanVector(outputs,0,1);

		modelOutput->SO[248][states[248]++] = 0;
		modelOutput->OS[0][outputs[0]++] = 248;
	simulator->model = QSS_Model(MOD_definition,MOD_dependencies,NULL,NULL,NULL);
	free(outputs);
	free(states);
}

void
CLC_initializeDataStructs (CLC_simulator simulator)
{
}
